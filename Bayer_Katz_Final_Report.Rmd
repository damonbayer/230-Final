---
title: "Gibbs Sampling with Data Augmentation for Bayesian Analysis of Binary and Polychotomous Response Data"
subtitle: "STAT 230 Final Report"
author: "Damon Bayer & Corey Katz"
date: "12/16/2019"
output:
  pdf_document:
    toc: true
    toc_depth: 2
    number_sections: true
    df_print: kable
bibliography: references.bib
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(here)
source(here("plotting_functions.R"))

post_sample_summary <- function(post) {
  post %>% 
  pivot_longer(everything()) %>% 
  rename(Variable = name) %>% 
  group_by(Variable) %>% 
  summarize_all(list(mean = mean,
                     sd = sd,
                     "2.5%" = function(x) quantile(x, probs = 0.025),
                     "50%" = median,
                     "97.5%" = function(x) quantile(x, probs = 0.975)))
}
```

# Abstract

Here's the abstract.

# Introduction
<!-- (explaining the motivation behind the new algorithm) -->

We cite @albertchib93

Here's the introduction.

# Methodology
<!-- (explaining the algorithm), -->

Here's the methodology.

# Results
<!-- (applying your algorithm to simulated or real data) -->

For three datasets, we apply the appropriate previously discussed model as well as standard maximum likelihood estimation and custom models written in Stan [@mcstan] and impelemented in the RStan package [@rstan].

Here's the results.

## Small-Cell Carcinoma

<!-- The small-cell carcinoma data comes from our STAT 211 class. Small-cell carcinoma of the lung is an aggressive cancer, but does respond to chemotherapy -->


<!-- 􏰀 Astudywasperformedinwhichpatientswererandomizedto receive a sequential therapy, with the same drug combination in each cycle, or an alternating therapy, with three different combinations given in alternating cycles -->
<!-- 􏰀 Attheendoftreatment,tumorresponsewascategorizedas: 1. Progressive -->
<!-- 2. No change -->
<!-- 3. Partial remission -->
<!-- 4. Complete remission -->
<!-- 􏰀 Thedataareorganizedbytherapygroupandbysex,withcounts in each of 4 ordered categories -->

```{r Ordered Multinomial,echo=FALSE}
ordered_multinomial_post <- read_rds(here("ordered_multinomial.rds"))

post_sample_summary(ordered_multinomial_post)

trace_plot(ordered_multinomial_post)
dist_plot(ordered_multinomial_post)
```



## Baseball


## Breast Cancer Data

We evaluate the probit regression methods on the Wisconsin Breast Cancer dataset, obtained from the University of Wisconsin Hospitals, Madison from Dr. William H. Wolberg \cite{wolberg1990multisurface}. The data reports 9 discrete measurements for 699 observations of clumps of breast cancer cells. The variables are Clump Thickness, Uniformity of Cell Size, Uniformity of Cell Shape, Marginal Adhesion, Single Epithelial Cell Size, Bare Nuclei, Bland Chromatin, Normal Nucleoli, and Mitoses. We remove 16 missing observations from the dataset to arrive at a final dataset with $n = 683$, $p = 9$.



Stan: 5000 iteration, 1000 burn in, 4000 posterior samples, 29.4429 sec
R: 8.235 seconds


# Discussion
<!-- (shortcomings of this new algorithm and how it can be improved). -->

Here's the discussion.

\pagebreak

# References

::: {#refs}
:::

\pagebreak

# Appendix